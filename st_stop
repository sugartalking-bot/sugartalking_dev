#!/bin/bash
set -e

# Colors
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m'

# Configuration
IMAGE_NAME="sugartalking"

echo -e "${YELLOW}Stopping Sugartalking...${NC}\n"

# Scale deployment to 0
echo -e "${YELLOW}Scaling deployment to 0...${NC}"
kubectl scale deployment/${IMAGE_NAME} -n default --replicas=0

# Wait for pods to terminate
echo -e "${YELLOW}Waiting for pods to terminate...${NC}"
kubectl wait --for=delete pod -l app=${IMAGE_NAME} -n default --timeout=60s 2>/dev/null || true

echo -e "\n${GREEN}════════════════════════════════════════${NC}"
echo -e "${GREEN}  Sugartalking stopped successfully!${NC}"
echo -e "${GREEN}════════════════════════════════════════${NC}\n"

echo -e "${YELLOW}To start again: ./st_start${NC}"
echo -e "${YELLOW}To completely remove: kubectl delete -f kubernetes/base/${NC}"
